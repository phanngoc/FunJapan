function loadArticlePhotos(n,t,i,r){var f={articleId:mpfArticlePhoto_articleId,skip:n,top:mpfArticlePhoto_requestCount,orderBy:t,filter:i+r},u;n==0?($(".articlephoto-area").empty(),u=null):(u=[],$(".articlephoto").each(function(){u.push($(this).data("articlephotoId"))}));$(".articlephoto-area").append('<p class="articlephoto-loading text-center">Now Loading...<\/p>');mpfArticlePhoto_isManageArticlePhoto?MPF.api.article.photo.getArticlePhotosByAdmin(f).done(function(n){$(".articlephoto-loading").remove();buildArticlePhotos(n,u)}):MPF.api.article.photo.getArticlePhotos(f).done(function(n){$(".articlephoto-loading").remove();buildArticlePhotos(n,u)})}function buildArticlePhotos(n,t){mpfArticlePhoto_requestCount<=n.value.length?$(".articlephoto-more").removeClass("hidden"):$(".articlephoto-more").addClass("hidden");$.each(n.value,function(n,i){var r=i.Message,u,e,f,o;(i.Message.replace(/\n/g,"").length>MPF.articlePhoto.getMessageMaxLength()&&(r=i.Message.replace(/\n/g,"").substr(0,MPF.articlePhoto.getMessageMaxLength())+"..."),(r==null||r=="")&&(r="&nbsp;"),u=new Date(i.PostedDate),e=u.getFullYear()+"-"+("0"+(u.getMonth()+1)).substr(-2)+"-"+("0"+u.getDate()).substr(-2)+" "+("0"+u.getHours()).substr(-2)+":"+("0"+u.getMinutes()).substr(-2),t!=null&&$.inArray(i.Id,t)>=0)||(mpfArticlePhoto_isManageArticlePhoto?(f=MPF.current.device.isDesktop?"col-xs-3":"col-xs-6 col-sm-4 col-md-3 col-lg-2",o='<div class="articlephoto '+f+' text-center" data-articlephoto-id="'+i.Id+'"><div class="articlephoto-status alert '+MPF.articlePhoto.getStatusClass(i.IsApproved)+'" data-articlephoto-id="'+i.Id+'"><strong>'+MPF.articlePhoto.getStatusName(i.IsApproved)+'<\/strong><div class="form-group checkbox"><input type="checkbox" name="articlephoto-check" value="'+i.Id+'"/><\/div><\/div><div class="articlephoto-image"><a class="image-popup-vertical-fit" href="'+i.Blobs[0].PhotoUrl+'" title="'+i.Message+'"><img class="img-thumbnail" src="'+i.Blobs[0].ThumbnailUrl+'"/><\/a><\/div><div class="text-left"><div class="articlephoto-approves"><a class="articlephoto-approve" data-articlephoto-id="'+i.Id+'" href="javascript:void(0);" ><i class="fa fa-thumbs-o-up"><\/i> Approve<\/a><\/div><div><a class="articlephoto-reject" data-articlephoto-id="'+i.Id+'" href="javascript:void(0);" ><i class="fa fa-thumbs-o-down"><\/i> Reject<\/a><\/div><\/div><div><div class="text-left articlephoto-meta"><span class="datetime">'+e+'<\/span><a href="javascript:void(0)" class="engagement-favorite articlephoto-like" data-articlephoto-id="'+i.Id+'">'+MPF.articlePhoto.getLikeHtml(i.Stats.LikeCount)+'<\/a><\/div><strong><p class="articlephoto-postedby" data-articlephoto-id="'+i.Id+'"><\/p>&nbsp;<\/strong><div class="articlephoto-message-mng"><p class="text-left">'+r+"<\/p><\/div><\/div><\/div>"):(f=MPF.current.device.isDesktop?"col-xs-4":"col-xs-6 col-sm-4 col-md-3 col-lg-2",o='<div class="articlephoto '+f+' text-center" data-articlephoto-id="'+i.Id+'"><div class="articlephoto-image"><a class="image-popup-vertical-fit" href="'+i.Blobs[0].PhotoUrl+'" title="'+i.Message+'"><img class="img-thumbnail" src="'+i.Blobs[0].ThumbnailUrl+'" /><\/a><\/div><div><div class="text-left articlephoto-meta"><span class="datetime">'+e+'<\/span><a href="javascript:void(0)" class="engagement-favorite articlephoto-like" data-articlephoto-id="'+i.Id+'" >'+MPF.articlePhoto.getLikeHtml(i.Stats.LikeCount)+'<\/a><\/div><strong><p class="articlephoto-postedby" data-articlephoto-id="'+i.Id+'">&nbsp;<\/p><\/strong><div class="articlephoto-message"><p class="text-left">'+r+"<\/p><\/div><\/div><\/div>"),$(".articlephoto-area").append(o),$(".articlephoto-image").height($(".articlephoto").width()),MPF.getPublicUserProfile(i.PostedBy).done(function(n){$(".articlephoto-postedby[data-articlephoto-id^='"+i.Id+"']").text(n.DisplayName.split(" ")[0].substr(0,15))}).fail(function(n){n.status==404&&$(".articlephoto-postedby[data-articlephoto-id^='"+i.Id+"']").text("(Someone)")}))});$(".articlephoto-like").unbind("click");$(".articlephoto-like").click(function(){var n,t,i,r;if($(this).hasClass("disabled"))return!1;if($(this).addClass("disabled"),n=$(this),t=n.data("articlephotoId"),!MPF.current.user.isAuthenticated){i=$.param($.extend({},{itemid:MPF.current.itemId}));location.href=i?MPF.config.loginUrl+"?"+i:MPF.config.loginUrl;return}r=parseInt(n.text());n.hasClass("liked")?(n.html(MPF.articlePhoto.getLikeHtml(r-1)),n.removeClass("liked")):(n.html(MPF.articlePhoto.getLikeHtml(r+1)),n.addClass("liked"));MPF.api.article.photo.toggleLikeArticlePhoto(t).done(function(){MPF.api.article.photo.addLikePointInStages(t).done(function(n){if(n.Stage!=null){$(".articlephoto-dialog .modal-body").html('<p><b>You\'ve got <b style="color:red;">'+n.Gauge+'<\/b> FP !<\/b><\/p><p>You\'ve achived <b style="color:red;">'+n.Stage+"<\/b> favorites. <\/p>");$(".articlephoto-dialog").modal("show");var t=parseInt($(".funjapan-points").text().replace(/[^0-9]/g,""));$(".funjapan-points").text(String(t+n.Gauge).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")+" FP")}})});$(this).removeClass("disabled")});$(".articlephoto-like").each(function(){if(MPF.current.user.isAuthenticated){var n=$(this),t=n.data("articlephotoId");MPF.api.article.photo.isLikedArticlePhoto(t).done(function(t){var i=parseInt(n.text());t.value?(n.html(MPF.articlePhoto.getLikeHtml(i)),n.addClass("liked")):(n.html(MPF.articlePhoto.getLikeHtml(i)),n.removeClass("liked"))})}});$(".articlephoto-approve").unbind("click");$(".articlephoto-approve").click(function(){var n=$(this).data("articlephotoId");MPF.articlePhoto.approve(n)});$(".articlephoto-reject").unbind("click");$(".articlephoto-reject").click(function(){var n=$(this).data("articlephotoId");MPF.articlePhoto.reject(n)});$(".articlephoto").length==0&&$(".articlephoto-area").append("<p>There are no posts.<\/p>");$(".image-popup-vertical-fit").magnificPopup({type:"image",closeOnContentClick:!0,mainClass:"mfp-img-mobile",image:{verticalFit:!0}})}$(function(){if(typeof mpfArticlePhoto_isManageArticlePhoto!="undefined"){var i=0,r=$(".articlephoto-order a.current-order").data("orderby"),t="true",n="";mpfArticlePhoto_isManageArticlePhoto&&(t=$(".articlephoto-filter a").data("filter"),mpfArticlePhoto_articleId=$(".articlephoto-select-article option:selected").prop("value"));var f=50,e=30,o=30,u=function(){var n="",t=$.trim($(".articlephoto-search input").val());return t!=""&&(n=" and contains(Author/DisplayName,'"+t+"')"),n};MPF.articlePhoto={approvedName:"Approved",rejectedName:"Rejected",pendingName:"Pending",approvedClass:"alert-success",rejectedClass:"alert-danger",pendingClass:"alert-info",getLikeHtml:function(n){return'<i class="fa fa-heart"><\/i><span><b>'+("    "+n).substr(-4).replace(/ /g,"&nbsp;")+"<\/b><\/span>"},getMessageMaxLength:function(){var n=o;return MPF.current.device.isDesktop&&(n=f,mpfArticlePhoto_isManageArticlePhoto&&(n=e)),n},getStatusName:function(n){switch(n){case!0:return MPF.articlePhoto.approvedName;case!1:return MPF.articlePhoto.rejectedName;default:return MPF.articlePhoto.pendingName}},getStatusClass:function(n){switch(n){case!0:return MPF.articlePhoto.approvedClass;case!1:return MPF.articlePhoto.rejectedClass;default:return MPF.articlePhoto.pendingClass}},approve:function(n){if(!MPF.current.user.isAuthenticated){var t=$.param($.extend({},{itemid:MPF.current.itemId}));location.href=t?MPF.config.loginUrl+"?"+t:MPF.config.loginUrl;return}MPF.api.article.photo.approveArticlePhoto(n).done(function(){$(".articlephoto-status[data-articlephoto-id^='"+n+"']").removeClass(MPF.articlePhoto.pendingClass+" "+MPF.articlePhoto.rejectedClass).addClass(MPF.articlePhoto.approvedClass).html("<strong>"+MPF.articlePhoto.approvedName+'<\/strong><div class="form-group checkbox"><input type="checkbox" name="articlephoto-check" value="'+n+'" /><\/div>')})},reject:function(n){if(!MPF.current.user.isAuthenticated){var t=$.param($.extend({},{itemid:MPF.current.itemId}));location.href=t?MPF.config.loginUrl+"?"+t:MPF.config.loginUrl;return}MPF.api.article.photo.rejectArticlePhoto(n).done(function(){$(".articlephoto-status[data-articlephoto-id^='"+n+"']").removeClass(MPF.articlePhoto.pendingClass+" "+MPF.articlePhoto.approvedClass).addClass(MPF.articlePhoto.rejectedClass).html("<strong>"+MPF.articlePhoto.rejectedName+'<\/strong><div class="form-group checkbox"><input type="checkbox" name="articlephoto-check" value="'+n+'" /><\/div>')})}};loadArticlePhotos(0,r,t,n);i+=mpfArticlePhoto_requestCount;$(".articlephoto-more").click(function(){$(this).addClass("hidden");loadArticlePhotos(i,r,t,n);i+=mpfArticlePhoto_requestCount});$(".articlephoto-order a").click(function(){if($(this).hasClass("disabled"))return!1;$(this).addClass("disabled");r=$(this).data("orderby");n=u();loadArticlePhotos(0,r,t,n);i=mpfArticlePhoto_requestCount;$(".articlephoto-order a").removeClass("current-order");$(this).addClass("current-order");$(this).removeClass("disabled")});$(".articlephoto-filter a").click(function(){if($(this).hasClass("disabled"))return!1;$(this).addClass("disabled");t=$(this).data("filter");n=u();loadArticlePhotos(0,r,t,n);i=mpfArticlePhoto_requestCount;$(".articlephoto-filter a").removeClass("current-filter");$(this).addClass("current-filter");$(this).removeClass("disabled")});$(".articlephoto-check-all").change(function(){$("input[name=articlephoto-check]").prop("checked",this.checked)});$(".articlephoto-upload .file").change(function(){$(this).val()&&!$(".file-input.has-error").length?$(".articlephoto-upload-btn").removeClass("hidden"):$(".articlephoto-upload-btn").addClass("hidden")});$(".articlephoto-select-article").change(function(){mpfArticlePhoto_articleId=$(".articlephoto-select-article option:selected").prop("value");n=u();loadArticlePhotos(0,r,t,n);i=mpfArticlePhoto_requestCount});$(".articlephoto-approve-checked").click(function(){$("input[name=articlephoto-check]").each(function(){if($(this).prop("checked")){var n=$(this).prop("value");MPF.articlePhoto.approve(n)}})});$(".articlephoto-reject-checked").click(function(){$("input[name=articlephoto-check]").each(function(){if($(this).prop("checked")){var n=$(this).prop("value");MPF.articlePhoto.reject(n)}})});$(".articlephoto-search .btn").click(function(){n=u();loadArticlePhotos(0,r,t,n);i=mpfArticlePhoto_requestCount});$(".articlephoto-search input").keyup(function(n){n.which==13&&$(".articlephoto-search .btn").click()});$(".articlephoto-search-minimize .btn").click(function(){$(".articlephoto-search").removeClass("hidden-xs");$(this).addClass("hidden")});$(window).resize(function(){$(".articlephoto-image").height($(".articlephoto").width())})}});
/*
//# sourceMappingURL=mpf.articlephoto.min.js.map
*/